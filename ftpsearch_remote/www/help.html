<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=koi8-r" />
<title>Search.bks-tv.ru &raquo; Help</title>
<link href="/main.css" rel="stylesheet" type="text/css" />
</head>

<body>
<table border="0" cellpadding="0" cellspacing="0" class="table2">
  <tr>
    <td class="tl2">&nbsp;</td>
    <td class="t2">&nbsp;</td>
    <td class="tr2">&nbsp;</td>
  </tr>
  <tr>
    <td class="l2">&nbsp;</td>
    <td><div align="center"><h1>О поисковике по FTP-серверам локальной сети БКС</h1></div>
    <h2>Содержание</h2>
    <ol>
    <li><a href="#osreal">Особенности реализации</a>
    <li><a href="#zamech">Замечания</a>
    <li><a href="#stats">Что такое статистика?</a>
    <li><a href="#browser">Что такое "Браузер FTP" и зачем он нужен?</a>
    <li><a href="#direrr">Почему при щелчке на ссылке на каталог в результатах поиска я не попадаю на FTP-сервер?</a>
    <li><a href="#about">На чем написан поисковик и как он работает?</a>
    <li><a href="#feedback">Обратная связь</a>
    <li><a href="#author">Об авторах</a>
    </ol>
    <hr>
    
    <h2><a name="osreal">Особенности реализации</a></h2> 
    <ul>
    <li>Возможность поиска по нескольким словам, разделенным пробелами;
    <li>Возможность задавать интервал поиска по размеру (т.е. одновременно "<b>от</b>" и "<b>до</b>") в <b>килобайтах</b> (для справки: используется каноническое правило <b>1 кб = 1024 байт</b>, а не "десятичные" размеры, принятые буржуйскими производителями винчестеров и DVD-дисков); также можно указывать только одну границу диапазона - поисковик для неуказанного значения "<b>от</b>" подставит <b>0 байт</b>, а для неуказанного значения "<b>до</b>" - <b>100 терабайт</b>;
    <li>Информация о <b>реальном</b> размере директории (размер директории = сумма размеров файлов, входящих в нее и во все поддиректории);
    <li>Если запрос возвращает большое количество ссылок (а именно <b>больше 100</b>), то на экран информация выводится страницами (<b>по 100 ссылок</b>). Перемещаться между страницами можно по ссылкам внизу страницы;
    <li>Показывается такая информация, как общее число совпадений (вверху страницы) и время выполнения запроса (внизу страницы);
    <li>Показывается время последнего сканирования каждого файла (это нужно, например, для проверки актуальности ссылки: чем "старее" время сканирования, тем меньше вероятность нахождения файла по указанному адресу);
    <li>По умолчанию происходит сортировка результатов запроса <b>в возрастающем порядке</b> по алфавиту: сначала по названию содержащей файл директории, при совпадении же директорий - по имени файла;
    <li>Возможность сортировки результатов поиска по размеру (галочка "<b>Сортировать по размеру</b>"): сначала сортировка <b>по убыванию</b> по размеру файла, при равенстве размеров - сортировка по умолчанию;
    <li>Возможность выбора между режимами поиска: "<b>Все слова (И)</b>" (по умолчанию) или "<b>Любое из слов (ИЛИ)</b>";
    <li>Возможность поиска в разных категориях: "<b>Только файлы</b>" и "<b>Только папки</b>". По умолчанию поиск ведется в обеих категориях (категория "<b>Файлы и папки</b>").
    <li>Возможность искать в полном пути (т.е. используется одновременно вся файловая иерархия) - для этого нужно поставить соответствующую галочку. Например, нужно найти альбом <b>Once</b> группы <b>Nightwish</b>. Поиск по двум словам одновременно (т.е. строка запроса - "<b>once nightwish</b>") результата не дает, а поиск по названию альбома даст в итоге ссылки более чем на 400 файлов. Выход - поставить галочку "<b>Искать в полном пути</b>" и ввести "<b>nightwish once</b>". 
    </ul>
    
    <h2><a name="zamech">Замечания</a></h2>
    <ul>
    <li>Предположительно база данных будет обновляться один раз в сутки (около 5 часов утра);
    <li>Использование галочки "<b>Искать в полном пути</b>" существенно замедляет время поиска (на порядок). <b>Не злоупотребляйте</b> этой функцией, иначе из-за сильных нагрузок на сервер придется эту возможность убрать;
    <li><i>Хотя бы одно</i> <b>допустимое</b> слово (т.е. слово после вырезания символов '<b>*</b>', '<b>%</b>', '<b>_</b>', '<b>@</b>') запроса должно быть <b>не меньше 3-х символов</b> в случае поиска по всем словам (или <i>все</i> допустимые слова должны быть <b>не меньше 3-х символов</b> в случае поиска по любому из слов); 
    <li>Регулярные выражения (типа * и пр.) <b>не поддерживаются</b> (однако в силу того, что многие help не читают и ставят '<b>*</b>' везде и повсюду, этот знак при предварительной обработке запроса заменяется на пробел);
    <li>Поиск <b>регистроНЕзависимый</b>;
    <li>При щелчке на ссылке с русскими символами в <b>Internet Explorer</b> откроется соотв. директория или будет предложено скачать файл, если заблаговременно <b>зажать SHIFT</b>.
    </ul>
    
    <h2><a name="stats">Что такое статистика?</a></h2>
    Для получения информации о проиндексированных серверах на текущий момент, а также для показа статистики использования поисковика, была сделана страница, доступная по ссылке <a href="http://search.bks-tv.ru/cgi/fstats.pl"><b>Статистика</b></a> с основной странцы поиска, и включающая в себя такие пункты как:
    <ul>
    <li><b>Индексируемые FTP-сервера</b> (с общим объемом проиндексированных данных);
    <li><b>50 последних запросов</b>.
    </ul>
    
    <h2><a name="browser">Что такое "Браузер FTP" и зачем он нужен?</a></h2>
    <b>Браузер FTP-серверов локальной сети БКС</b> (доступный по ссылке <a href="http://search.bks-tv.ru/cgi/fdir.pl"><b>Браузер FTP</b></a> с основной странцы поиска) - это своего рода проводник по FTP-серверам, построенный на основе их файловой иерархии. Его отличие от использования фтп-клиента следующие:
    <ol>
    <li>При перемещении по файловой иерархии (щелкая по ссылкам на названия директорий), на самом деле мы видим всего лишь специально организованную информацию из <b>Базы Данных</b>;
    <li>В силу п.1 не создается отдельного фтп-соединения с сервером, в силу чего снижается нагрузка на него;
    <li>В силу п.2, при временном падении уже проиндексированного сервера, мы все равно сможем смотреть содержимое его папок;
    <li>Разные FTP-сервера могут иметь разные кодировки названий файлов; в браузере же все кодировки преобразованы к одной;
    <li>В фтп-клиенте нельзя просто взять и посмотреть размер директории вместе со всеми файлами и поддиректориями (для этого придется запускать рекурсивный подсчет), в браузере отображается уже подсчитанный на этапе <b>индексации</b> общий размер.
    </ol>
    
    <h2><a name="direrr">Почему при щелчке на ссылке на каталог в результатах поиска я не попадаю на FTP-сервер?</a></h2>
    Потому что Вы попадаете в <b>Браузер FTP-серверов локальной сети БКС</b> для просмотра содержимого запрошенного Вами каталога. Это было сделано для снижения нагрузки на и так перегруженные FTP-сервера. Если же Вам нужна реальная ссылка на сервер, то просто щелкните в открывшемся окне на название запрошенной папки (после слова "<b>Содержимое</b>"). А вот ссылки на обычные файлы ведут на сервер как в результатах поиска, так и в браузере.
    
    <h2><a name="about">На чем написан поисковик и как он работает?</a></h2>
    Поисковик состоит из трех концептуальных частей:
    <ul>
    <li><b>Индексатор</b>;
    <li><b>База данных</b>;
    <li>Собственно, сам <b>CGI-интерфейс поиска</b>.
    </ul>
    Его работу вкратце можно описать следующим образом:
    <ol>
    <li><i>Индексатор</i> - это программа, написанная на языке <b>Perl</b>, которая соединяется с фтп-сервером (или уже находится на нем - зависит от конкретной реализации) и производит его полное сканирование. 
    <li>Все данные о просканированных файлах заносятся в <i>базу данных</i> (<b>MySQL</b>, <b>Oracle</b>, <b>PostgreSQL</b> - опять же зависит от конкретной реализации) - это полный путь, имя файла, признак каталога, размер, время сканирования. 
    <li>И уже заключительный этап - взаимодействие через <i>CGI-интерфейс</i> с конечным пользователем - это и есть та страничка, которую вы используете для поиска. Этот интерфейс также написан на <b>Perl</b>, однако вместо стандартного тяжеловесного (но и в то же время универсального) модуля <b>CGI.pm</b> используются легкие и функциональные модули <b>CGI::WebIn</b> и <b>CGI::WebOut</b> от <b>Дмитрия Котерова</b> (<a href="http://www.dklab.ru">http://www.dklab.ru</a>).
    </ol>
    
    <h2><a name="feedback">Обратная связь</a></h2>
    Со всеми конструктивными замечаниями и предложениями, а также найденными багами просьба писать в тему <a href="http://forum.bks-tv.ru/index.php/topic,4437.0.html">"<b>Новый поиск по фтп серверам</b>"</a> на официальном форуме БКС.
    
    <h2><a name="author">Об авторах</a></h2>
    <p>Поисковик полностью написан <span style="color: #990000;"><b>anCHORiTe</b></span>: ICQ - 307514851, e-mail - petsan@newmail.ru.<br /> Дизайн и верстка <span style="color: #990000;"><b>RokeR</b></span>: ICQ - 431494134, e-mail - wizard1991@ya.ru.
    </p><HR>
    <div align="center"><a href="/search.html">|на главную|</a></div>
    </td>
    <td class="r2">&nbsp;</td>
  </tr>
  <tr>
    <td class="bl2">&nbsp;</td>
    <td class="b2">&nbsp;</td>
    <td class="br2">&nbsp;</td>
  </tr>
</table>
<div align="center" class="copyright">Programming by anCHORiTe<br />
  Design by RokeR</div>
</body>
</html>
